<!DOCTYPE html>
<html>
<head>
    <title>Radiance @ Admin</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1.0">
    <link rel="stylesheet" href="../styles.css">
    <script src="../flame.js"></script>
    <style type="text/css">
        body {
            background-color: #222;
            color: #ddd;
            line-height: 36px;
            font-size: 24px;
        }
        p {
            min-height: 0;
        }
        label:after {
            content: ": ";
        }
        output {
            font-weight: normal;
        }
    </style>
    <script>
        var Admin = function() {
            this.statusTimer = undefined;
        };

        Admin.prototype = {
            updateStatus: function(status) {
                document.getElementById("current-status-currentplayer").innerText = status["currentplayer"];
                document.getElementById("current-status-currentaverage").innerText = status["currentavg"];
                document.getElementById("current-status-running").innerText = status["running"];
            },

            setRunning: function(running) {
                api.get("admin.cgi?running=" + running, function() {
                    fire.pollStatus();
                });
            },
        }

        var admin = new Admin();

        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("running-button").addEventListener("click", function() {
                admin.setRunning("true");
            });

            document.getElementById("not-running-button").addEventListener("click", function() {
                admin.setRunning("false");
            });

            fire.statusCallback = function(status) {
                admin.updateStatus(status);
            };
            fire.pollStatus();
        }, false);
    </script>
</head>
<body>
<div id="current-status">
    <p>
        <label for="current-status-currentplayer">Current Player</label>
        <output id="current-status-currentplayer"></output>
    </p>
    <p>
        <label for="current-status-currentaverage">Current Average</label>
        <output id="current-status-currentaverage"></output>
    </p>
    <p>
        <label for="current-status-running">Running</label>
        <output id="current-status-running"></output>
    </p>
</div>
<div>
    <h3>Set Status</h3>
    <input id="running-button" type="button" value="Running">
    <input id="not-running-button" type="button" value="Not Running">
</div>
</body>
</html>